@model CRMBussiness.ViewModel.DisplayTimeKeepingViewmodel
@section Styles{
    <style>
        #main .main-content .tr_left-border table tr:hover td {
            color: #5f6fff;
        }
    </style>
}

<section class="section_employee-attendance">
    <div class="module module-title">
        <img src="/Assets/crm/images/layout/left-arrow.svg" alt="" />
        <h2>Chấm công</h2>
    </div>
    <div class="module module-content">
        <div class="search">
            <div class="search-item input-group">
                <label for="">Thời gian</label>
                <div class="date-select">
                    <input id="selected-month" type="text" class="search__input only-month" />
                    <img src="/Assets/crm/images/layout/date.svg" alt="" />
                </div>
            </div>
            <div class="search-item input-group">
                <label for="">Từ khóa</label>
                <input placeholder="Nhập từ khóa" id="key-search" />
            </div>
            <button class="btn-green mb-16" id="search-time">Tìm kiếm</button>
        </div>

        <div class="handle">
            <style>
                .setup-container {
                    display: inline-block;
                    margin: 5px;
                }

                    .setup-container input {
                        max-width: 120px;
                    }

                .tool-box {
                    width: 50%;
                }

                    .tool-box .box {
                        float: right;
                    }

                    .tool-box button {
                        margin: 5px;
                    }
            </style>
            <div class="setup-container">
                <label for="#total-working-setup">Số công chuẩn trong tháng</label>
                <input type="number" style="max-width: 70px" id="total-working-setup" disabled value="@Model.TotalDaysInMonth" />

                <label for="#other-bonus-setup">Thưởng trong tháng</label>
                <input type="text" id="other-bonus-setup" disabled value="@(String.Format("{0:#,0}", Model.Bonus))" />
            </div>
            <div class="tool-box">
                <div class="box">
                    <button class="handle-button"
                            modal-show="show"
                            modal-data="#attendance_import-modal"
                            @*style="margin-left:5px; margin-right: 5px;"*@
                            onclick="">
                        Nhập dữ liệu
                    </button>
                    <button class="handle-button" @*style="margin-left:5px; margin-right: 5px;"*@
                            onclick="toastr.info('Vui lòng chờ hệ thống đang tải mẫu chấm công'); window.location.href = '/HR/TimeKeeping/GetEmployeeListFile'">
                        Mẫu bảng chấm công
                    </button>
                    <button class="handle-button" modal-show="show"
                            modal-data="#attendance_setup-modal">
                        <div class="icon">
                            <img src="/Assets/crm/images/employee-attendance/setup.svg" alt="" />
                        </div>
                        Setup
                    </button>
                </div>
            </div>
        </div>

        <div class="data-table header-fixed responsive-table"  style="overflow: auto;">
            <table class="attendance_data-table" id="time-table" style="min-width: 1800px;">
                <tbody id="body-table">
                    <tr>
                        <th>ID</th>
                        <th>Họ và tên</th>
                        <th>Chức vụ</th>
                        <th>Công thực tế</th>
                        <th>Đi muộn</th>
                        <th>Về sớm</th>
                        <th>Nghỉ không lý do</th>
                        <th>Quên checkout</th>
                        <th>Nghỉ có phép</th>
                        <th>Tổng số show up(telesale)</th>
                        <th>Tổng số hợp đồng(telesale)</th>
                        <th>Tổng số doanh thu(sale)</th>
                        <th></th>
                    </tr>
                    @if (Model != null && Model.TimeKeepings != null && Model.TimeKeepings.Count > 0)
                    {
                        foreach (var item in Model.TimeKeepings)
                        {
                            <tr>
                                <td class="no-border">
                                    <span id="@item.Id" data-code="@item.CodeKeeping">@item.CodeStaff</span>
                                </td>
                                <td class="no-border">
                                    <span>@item.FullName</span>
                                </td>
                                <td class="no-border" data-role="@item.RoleAccount">
                                    <span>@(CRMSite.Common.Helper.GetRoleName(item.RoleAccount))</span>
                                </td>

                                <td>
                                    <input type="text" min="0" class="total-working-days isOneDecimalNumber" value="@(item.TotalWorkingDays ?? 0)" style="text-align: center" />
                                </td>

                                <td>
                                    <input type="number" min="0" class="total-lates" value="@(item.TotalLates ?? 0)" style="text-align: center" />
                                </td>

                                <td>
                                    <input type="number" min="0" class="total-early-outs" value="@(item.TotalEarlyOuts ?? 0)" style="text-align: center" />
                                </td>

                                <td>
                                    <input type="number" min="0" class="total-without-reason" value="@(item.TotalWithoutReason ?? 0)" style="text-align: center" />
                                </td>

                                <td>
                                    <input type="number" min="0" class="forget-check-outin" value="@(item.ForgetCheckOutIn ?? 0)" style="text-align: center" />
                                </td>

                                <td>
                                    <input type="text" class="take-leave-in-month isOneDecimalNumber" value="@(item.TotalTakeLeaveInMonth ?? 0)" style="text-align: center" />
                                </td>

                                <td>
                                    <input type="text" min="0" class="showup-in-month isOneDecimalNumber"
                                           value="@((item.RoleAccount == 8 || item.RoleAccount == 9) ? (item.TotalShowupInMonth??0).ToString()
                                    : string.Empty)"
                                           style="text-align: center"
                                           disabled />
                                </td>

                                <td>
                                    <input type="text" min="0" class="contracts-in-month isOneDecimalNumber"
                                           value="@((item.RoleAccount == 8 || item.RoleAccount == 9) ?
                                    (item.TotalContract??0).ToString(): string.Empty)"
                                           disabled
                                           style="text-align: center" />
                                </td>

                                <td>
                                    @*<input type="text" min="0" class="revenue-in-month isNumber" value="@((item.RoleAccount != 8 && item.RoleAccount != 9) ? (String.Format("{0:#,0}", item.RevenueInMonth??0)) : string.Empty)" style="text-align: center; min-width: 150px;" />*@
                                    @*NamNP : Doanh số cá nhân của sale, leader sale, managesale.*@
                                    <input type="text" min="0" class="revenue-in-month isNumber"
                                           value="@((item.RoleAccount == 4 || item.RoleAccount == 5 || item.RoleAccount == 6)
                                        ? (String.Format("{0:#,0}", item.RevenueInMonth??0)) : string.Empty)"
                                           style="text-align: center; min-width: 150px;"
                                           disabled />
                                </td>

                                <td>
                                    <div class="more-options attendance_more-options">
                                        <img src="/Assets/crm/images/employee-attendance/more-options.svg"
                                             alt="" />
                                        <div class="options">
                                            <button class="option-item"
                                                    type="button"
                                                    onclick="OpenEditingBonus('@item.Id')">
                                                <img src="/Assets/crm/images/employee-attendance/gift.svg"
                                                     alt="" />
                                                <span>Thưởng khác</span>
                                            </button>
                                            @*<button class="option-item"
                                                    type="button"
                                                    onclick="OpenEditingModal('@item.Id')">
                                                <img src="/Assets/crm/images/employee-attendance/edit.svg"
                                                     alt="" />
                                                <span>Chỉnh sửa</span>
                                            </button>*@
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>

        @*<div class="group-button" id="action-btns">
            <button class="btn-gray" id="cancel-time">Hủy bỏ</button>
            <button class="btn-green" id="update-time">Cập nhật</button>
        </div>*@

        <!-- edit modal -->
        <div class="bs-modal" id="attendance_edit-modal">
            <div class="modal-frame">
                <div class="content-modal">

                </div>
            </div>
        </div>

        <!-- gift modal -->
        <div class="bs-modal" id="attendance_gift-modal">
            <div class="modal-frame">
                <div class="content-modal">
                    <div class="header-modal">
                        <h3 class="modal__title">Thêm mới thưởng khác</h3>
                        <span title="close" modal-show="close" class="close__modal">
                            <img src="/Assets/crm/images/layout/close-modal.svg" alt="" />
                        </span>
                    </div>
                    <input type="hidden" min="0" name="Id" id="hiddenId" />
                    <div class="body-modal">
                        <div class="modal-item">
                            <label for="">Thưởng khác</label>
                            <input type="text" class="isNumber" min="0" name="OtherBonus" />
                        </div>
                    </div>
                    <div class="footer-modal">
                        <button id="save-bonus"
                                class="close__btn btn-green"
                                type="button">
                            Thêm mới
                        </button>
                        <button modal-show="close"
                                class="close__btn btn-gray"
                                type="button">
                            Hủy bỏ
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- set up -->
        <div class="bs-modal" id="attendance_setup-modal">
            <div class="modal-frame">
                <div class="content-modal">
                    <div class="header-modal">
                        <h3 class="modal__title">SET UP CHUNG</h3>
                        <span title="close" modal-show="close" class="close__modal">
                            <img src="/Assets/crm/images/layout/close-modal.svg" alt="" />
                        </span>
                    </div>
                    <div class="body-modal">
                        <form id="rule_form">
                            <div class="bs-row">
                                <div class="bs-col md-50">
                                    <div class="modal-item">
                                        <label for="">Thời gian</label>
                                        <div class="date-select">
                                            <input name="Month" type="text" class="search__input only-month" />
                                            <img src="/Assets/crm/images/layout/date.svg" alt="" />
                                        </div>
                                    </div>
                                </div>
                                <div class="bs-col md-50">
                                    <div class="modal-item">
                                        <label for="">Số ngày công chuẩn</label>
                                        <input name="TotalWorkingDays" placeholder="Nhập số ngày công" type="number" min="0" />
                                    </div>
                                </div>
                                <div class="bs-col md-50">
                                    <div class="modal-item">
                                        <label for="">Thưởng khác</label>
                                        <input type="text" class="isNumber" min="0" name="OtherBonus" />
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="footer-modal">
                        <button id="save-rule"
                                class="close__btn btn-green"
                                type="button">
                            Lưu
                        </button>
                        <button modal-show="close"
                                class="close__btn btn-gray"
                                type="button">
                            Hủy bỏ
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="bs-modal" id="attendance_import-modal">
            <div class="modal-frame">
                <div class="content-modal">
                    <div class="header-modal">
                        <h3 class="modal__title">NHẬP DỮ LIỆU</h3>
                        <span title="close" modal-show="close" class="close__modal">
                            <img src="/Assets/crm/images/layout/close-modal.svg" alt="" />
                        </span>
                    </div>
                    <div class="body-modal">
                        <form id="import-form" enctype="multipart/form-data">
                            <div class="bs-row">
                                <div class="bs-col md-50">
                                    <div class="modal-item">
                                        <label for="">Thời gian</label>
                                        <div class="date-select">
                                            <input name="month" type="text" class="search__input only-month" />
                                            <img src="/Assets/crm/images/layout/date.svg" alt="" />
                                        </div>
                                    </div>
                                </div>
                                <div class="bs-col md-50">
                                    <div class="modal-item">
                                        <label for="">Bảng chấm công</label>
                                        <input name="file" placeholder="Chọn file chấm công" type="file"
                                               accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"/>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="footer-modal">
                        <button id="import-data"
                                class="close__btn btn-green"
                                type="button">
                            Nhập dữ liệu
                        </button>
                        <button modal-show="close"
                                class="close__btn btn-gray"
                                onclick=" $('#attendance_import-modal input').val('');"
                                type="button">
                            Hủy bỏ
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts{
    <script src="~/js/controllers/timekeeping.js"></script>
}